from Vulnerabilities.Vulnerability import Vulnerability, VulnerabilityType
from vendor_type import DeviceType


class SMTPUserEnumeration(Vulnerability):
    def __init__(self):
        """
        –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–∞.
        """
        super().__init__()  # –í—ã–∑–æ–≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—Å–∞
        self.name = "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—Ö–æ–¥–∞ –±–µ–∑ –ø–∞—Ä–æ–ª—è"
        self.desc = ("–ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å–µ—Ä–≤–∏—Å—ã (MQTT, FTP, Telnet) –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Ç–∞–∫, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –±–µ–∑ –ø–∞—Ä–æ–ª—è –∏–ª–∏ —Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏/—Å–ª–∞–±—ã–º–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏.")
        self.threats = ('''—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∞–º:

     –ü–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.

     –ß–∏—Ç–∞—Ç—å, –∏–∑–º–µ–Ω—è—Ç—å –∏–ª–∏ —É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª—ã (–≤ —Å–ª—É—á–∞–µ FTP).

    üìå–ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (–æ—Å–æ–±–µ–Ω–Ω–æ –≤ Telnet, –≥–¥–µ —Ç—Ä–∞—Ñ–∏–∫ –Ω–µ —à–∏—Ñ—Ä—É–µ—Ç—Å—è).

     –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä –¥–ª—è –∞—Ç–∞–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞—Å—Å—ã–ª–∫–∏ —Å–ø–∞–º–∞ –∏–ª–∏ DDoS).''')
        self.methods = '''    –í—Å–µ–≥–¥–∞ –º–µ–Ω—è–π—Ç–µ –ø–∞—Ä–æ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–æ–≤—ã–π, —Å—Ä–∞–∑—É –∑–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏).

    –û—Ç–∫–ª—é—á–∏—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã (–æ—Å–æ–±–µ–Ω–Ω–æ Telnet ‚Äî –æ–Ω –Ω–µ–±–µ–∑–æ–ø–∞—Å–µ–Ω –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ).

üîß –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

MQTT:

    –ù–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø—É–Ω–∫—Ç ¬´MQTT¬ª ‚Üí ¬´–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è¬ª.

    –í–∫–ª—é—á–∏—Ç–µ:

        –ó–∞–ø—Ä–µ—Ç–∏—Ç—å –∞–Ω–æ–Ω–∏–º–Ω—ã–π –¥–æ—Å—Ç—É–ø

        –¢—Ä–µ–±–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å

    –ó–∞–¥–∞–π—Ç–µ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å (–ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π).
FTP:

    –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö FTP-—Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞–π–¥–∏—Ç–µ:

        Anonymous access ‚Üí –í—ã–∫–ª—é—á–∏—Ç—å

        Password required ‚Üí –í–∫–ª—é—á–∏—Ç—å
Telnet:

    –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç–µ Telnet ‚Äî –∑–∞–º–µ–Ω–∏—Ç–µ –µ–≥–æ –Ω–∞ SSH (–µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç).

    –î–ª—è —Å—Ç–∞—Ä—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:

        –ù–∞–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö ¬´–£–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø¬ª ‚Üí ¬´–û—Ç–∫–ª—é—á–∏—Ç—å Telnet¬ª.

'''

    def check_for_device(self, device):
        pass

    def check(self, devices):
        vulnerable_devices = {}
        print(devices)
        for i in devices:
            if i['type'] != DeviceType.Skip:
                print('device', i['ip'], i['type'])
                cur = self.check_for_device(i)
                if cur:
                    if i['mac'] in vulnerable_devices:
                        vulnerable_devices[i['mac']].append(VulnerabilityType.MQTTPubSub)
                    else:
                        vulnerable_devices[i['mac']] = VulnerabilityType.MQTTPubSub
        return vulnerable_devices
